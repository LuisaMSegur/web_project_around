!function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var r=document.querySelector("#card-template").content,o=function(){return t=function t(e,n,r,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e.name,this.link=e.link,this._id=e._id,this.likes=Array.isArray(e.likes)?e.likes:[],this.userId=i,this.handleClickImage=n,this.handleClickDelete=r,this.handleLikeUpdate=o,this.setProperties()},(n=[{key:"getTemplate",value:function(){return r.querySelector(".card").cloneNode(!0)}},{key:"setProperties",value:function(){this.htmlCard=this.getTemplate(),this.cardImage=this.htmlCard.querySelector(".card__photo"),this.cardTitle=this.htmlCard.querySelector(".card__name-place"),this.buttonLikeCard=this.htmlCard.querySelector(".card__button-love"),this.buttonDeleteCard=this.htmlCard.querySelector(".card__button-trash"),this.cardLikes=this.htmlCard.querySelector(".card__like"),this.cardTitle.textContent=this.name,this.cardImage.src=this.link,this.showLikes()}},{key:"showLikes",value:function(){this.cardLikes.textContent=this.likes.length,this.buttonLikeCard.classList.toggle("card__button-love_active",this.likes.includes(this.userId))}},{key:"handleLikes",value:function(){var t=this;this.likes.includes(this.userId)?(this.likes=this.likes.filter((function(e){return e!==t.userId})),this.handleLikeUpdate(this._id,!1)):(this.likes.push(this.userId),this.handleLikeUpdate(this._id,!0)),this.showLikes()}},{key:"removeCard",value:function(){this.htmlCard.remove()}},{key:"setEventListeners",value:function(){var t=this;this.cardImage.addEventListener("click",(function(){t.handleClickImage()})),this.buttonDeleteCard.addEventListener("click",(function(){t.handleClickDelete(t._id)})),this.buttonLikeCard.addEventListener("click",(function(){t.handleLikes()}))}},{key:"closeOnEsc",value:function(t){"Escape"===t.key&&this.closePopUpImage()}},{key:"closeClickOutForm",value:function(t,e){e.target===t&&this.closePopUpImage()}},{key:"openPopUpImage",value:function(){var t=this,e=document.querySelector("#popup-image"),n=e.querySelector(".popup__photo"),r=e.querySelector(".popup__photo-title");e.classList.add("popup_open"),r.textContent=this.name,n.src=this.link,document.addEventListener("keydown",this.closeOnEsc.bind(this)),document.addEventListener("click",(function(n){return t.closeClickOutForm(e,n)}))}},{key:"closePopUpImage",value:function(){document.querySelector("#popup-image").classList.remove("popup_open"),document.removeEventListener("keydown",this.closeOnEsc.bind(this))}},{key:"setCard",value:function(){return this.setProperties(),this.setEventListeners(),this.htmlCard}}])&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var a=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.formElement=e,this.settings=n,this.inputList=Array.from(this.formElement.querySelectorAll(this.settings.inputSelector)),this.buttonElement=this.formElement.querySelector(this.settings.submitButtonSelector)},(e=[{key:"showInputError",value:function(t,e){var n=this.formElement.querySelector("#".concat(t.id,"-error"));t.classList.add(this.settings.inputErrorClass),n.textContent=e,n.classList.add(this.settings.errorClass)}},{key:"hideInputError",value:function(t){var e=this.formElement.querySelector("#".concat(t.id,"-error"));t.classList.remove(this.settings.inputErrorClass),e.textContent="",e.classList.remove(this.settings.errorClass)}},{key:"checkInputValidity",value:function(t){t.validity.valid?this.hideInputError(t):this.showInputError(t,t.validationMessage)}},{key:"hasInvalidInput",value:function(){return this.inputList.some((function(t){return!t.validity.valid}))}},{key:"toggleButtonState",value:function(){this.hasInvalidInput()?(this.buttonElement.disabled=!0,this.buttonElement.classList.add(this.settings.inactiveButtonClass)):(this.buttonElement.disabled=!1,this.buttonElement.classList.remove(this.settings.inactiveButtonClass))}},{key:"setEventListeners",value:function(){var t=this;this.toggleButtonState(),this.inputList.forEach((function(e){e.addEventListener("input",(function(){t.checkInputValidity(e),t.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this.formElement.addEventListener("submit",(function(t){t.preventDefault()})),this.setEventListeners()}}])&&u(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),s={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},l=document.querySelector("#form-profile"),f=document.querySelector(".profile__title"),p=document.querySelector(".profile__subtitle"),y=document.querySelector("#avatar"),h=document.querySelector("#form-avatar"),m=document.querySelector("#form-card"),d=document.querySelector(".profile__button"),v=document.querySelector(".profile__button-add"),b=document.querySelector(".profile__photo_edit");function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,S(r.key),r)}}function S(t){var e=function(t){if("object"!=k(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:e+""}var g=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.popupElement=document.querySelector(e),this.closeButton=this.popupElement.querySelector(".popup__close"),this._handleEsClose=this._handleEsClose.bind(this)},(e=[{key:"openPopup",value:function(){this.popupElement.classList.add("popup_open"),document.addEventListener("keydown",this._handleEsClose)}},{key:"closePopup",value:function(){this.popupElement.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEsClose)}},{key:"_handleEsClose",value:function(t){"Escape"===t.key&&this.closePopup()}},{key:"handleClickOutside",value:function(t){return t.target.classList.contains("popup_open")}},{key:"setEventListeners",value:function(){var t=this;this.closeButton.addEventListener("click",(function(){t.closePopup()})),this.popupElement.addEventListener("click",(function(e){t.handleClickOutside(e)&&t.closePopup()}))}}])&&E(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t){if("object"!=w(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}function j(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(j=function(){return!!t})()}function C(t,e,n,r){var o=O(L(1&r?t.prototype:t),e,n);return 2&r&&"function"==typeof o?function(t){return o.apply(n,t)}:o}function O(){return O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=L(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},O.apply(null,arguments)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}function T(t,e){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},T(t,e)}var I=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,n){return e=L(e),function(t,e){if(e&&("object"==w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,j()?Reflect.construct(e,n||[],L(t).constructor):e.apply(t,n))}(this,e,[t])).formElement=r.popupElement.querySelector(".form"),r.inputList=r.formElement.querySelectorAll(".form__input"),r.handleFormSubmit=n,r.buttonSubmit=r.formElement.querySelector(".form__submit"),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e)}(e,t),n=e,(r=[{key:"getInputValues",value:function(){var t=this;return this.formValues={},this.inputList.forEach((function(e){t.formValues[e.name]=e.value})),this.formValues}},{key:"setEventListeners",value:function(){var t=this;C(e,"setEventListeners",this,3)([]),this.formElement.addEventListener("submit",(function(e){e.preventDefault(),t.handleFormSubmit(t.getInputValues()),t.closePopup()})),this.buttonSubmit.addEventListener("click",(function(){t.buttonSubmit.textContent="Cargando..."}))}},{key:"closePopup",value:function(){C(e,"closePopup",this,3)([]),this.formElement.reset()}}])&&P(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(g);function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function R(t){var e=function(t){if("object"!=q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(e)?e:e+""}function A(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(A=function(){return!!t})()}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},B.apply(null,arguments)}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}var V=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=x(e),function(t,e){if(e&&("object"==q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,A()?Reflect.construct(e,n||[],x(t).constructor):e.apply(t,n))}(this,e,[t])).imageElement=n.popupElement.querySelector(".popup__photo"),n.titleElement=n.popupElement.querySelector(".popup__photo-title"),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(e,t),n=e,r=[{key:"openPopup",value:function(t,n){var r,o,i;(r=e,o=this,"function"==typeof(i=B(x(1&3?r.prototype:r),"openPopup",o))?function(t){return i.apply(o,t)}:i)([]),this.titleElement.textContent=t,this.imageElement.src=n}}],r&&U(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(g);function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,J(r.key),r)}}function J(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}var G=function(){return t=function t(e){var n=e.name,r=e.about,o=e.avatar;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=n,this.about=r,this.avatar=o},(e=[{key:"getUserInfo",value:function(){return{name:this.name.textContent,about:this.about.textContent,avatar:this.avatar.src}}},{key:"setUserInfo",value:function(t,e){this.name.textContent=t,this.about.textContent=e}},{key:"setUserAvatar",value:function(t){this.avatar.src=t}}])&&N(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M(r.key),r)}}function M(t){var e=function(t){if("object"!=H(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==H(e)?e:e+""}var K=function(){return t=function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.items=Array.isArray(r)?r:[],this.renderer=o,this.container=document.querySelector(n)},(e=[{key:"renderItems",value:function(){var t=this;this.items.forEach((function(e){t.renderer(e)}))}},{key:"addCard",value:function(t){this.container.prepend(t)}}])&&z(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function X(t){var e=function(t){if("object"!=Q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Q(e)?e:e+""}var Y=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=e,this.headers=n},(e=[{key:"getUser",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{method:"GET",headers:this.headers}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"editUser",value:function(t,e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,"Content-Type":"application/json",body:JSON.stringify({name:t,about:e})}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"editAvatar",value:function(t){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"getCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{method:"GET",headers:this.headers}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"createCard",value:function(t,e){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,"Content-Type":"application/json",body:JSON.stringify({name:t,link:e})}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"deleteCard",value:function(t){return fetch("".concat(this.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:this.headers}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"addLikeCard",value:function(t){return fetch("".concat(this.baseUrl,"/cards/").concat(t,"/likes"),{method:"PUT",headers:this.headers}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}},{key:"removeLikeCard",value:function(t){return fetch("".concat(this.baseUrl,"/cards/").concat(t,"/likes"),{method:"DELETE",headers:this.headers}).then((function(t){return t.ok?t.json():Promise.reject("error en la petición")}))}}])&&W(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function tt(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}function et(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(et=function(){return!!t})()}function nt(){return nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=rt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},nt.apply(null,arguments)}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}function ot(t,e){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ot(t,e)}var it=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e,n){return e=rt(e),function(t,e){if(e&&("object"==Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,et()?Reflect.construct(e,n||[],rt(t).constructor):e.apply(t,n))}(this,e,[t])).action=function(){},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ot(t,e)}(e,t),n=e,r=[{key:"setAction",value:function(t){this.action=t}},{key:"setEventListeners",value:function(){var t,n,r,o=this;(t=e,n=this,"function"==typeof(r=nt(rt(1&3?t.prototype:t),"setEventListeners",n))?function(t){return r.apply(n,t)}:r)([]);var i=this.popupElement.querySelector("#buttonConfirmation");i?i.addEventListener("click",(function(){o.action()})):console.error("El botón de confirmación no se encontró en el popup.")}}],r&&$(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(g),ut=new Y("https://around.nomoreparties.co/v1/web-es-cohort-15",{authorization:"80b5e925-605c-4006-ba50-cc4527fb2e95","Content-Type":"application/json"}),ct=new G({name:f,about:p,avatar:y});ut.getUser().then((function(t){ct.setUserInfo(t.name,t.about,t.id),ct.setUserAvatar(t.avatar)})).catch((function(t){console.log(t)}));var at=new I("#popup-profile",(function(t){ut.editUser(t.name,t.about).then((function(t){ct.setUserInfo(t.name,t.about)})).catch((function(t){console.log(t)}))}));at.setEventListeners(),d.addEventListener("click",(function(){at.openPopup()}));var st=new I("#popup-avatar",(function(t){ut.editAvatar(t.avatar).then((function(t){ct.setUserAvatar(t.avatar)})).catch((function(t){console.log(t)}))}));st.setEventListeners(),b.addEventListener("click",(function(){st.openPopup()})),ut.getCards().then((function(t){lt.items=t,lt.renderItems()})).catch((function(t){console.log(t)}));var lt=new K({items:[],renderer:function(t){var e=new o(t,(function(){yt.openPopup(t.name,t.link)}),(function(t){ft.openPopup(),ft.setAction((function(){ut.deleteCard(t).then((function(){e.removeCard(),ft.closePopup()}))}))}),(function(t,n){n?ut.addLikeCard(t).then((function(t){e.likes=t.likes,e.showLikes()})):ut.removeLikeCard(t).then((function(t){e.likes=t.likes,e.showLikes()}))}),ct.userId);lt.addCard(e.setCard())}},".cards"),ft=new it("#popup-deleteCard");ft.setEventListeners();var pt=new I("#popup-card",(function(t){ut.createCard(t.title,t.link).then((function(t){var e=new o(t,(function(){yt.openPopup(t.name,t.link)}),(function(t){ft.openPopup(),ft.setAction((function(){ut.deleteCard(t).then((function(){e.removeCard(),ft.closePopup()}))}))}),(function(t,n){n?ut.addLikeCard(t).then((function(t){e.likes=t.likes,e.showLikes()})):ut.removeLikeCard(t).then((function(t){e.likes=t.likes,e.showLikes()}))}),ct.userId);lt.addCard(e.setCard()),pt.closePopup()}))}));pt.setEventListeners(),v.addEventListener("click",(function(){pt.openPopup()}));var yt=new V("#popup-image");yt.setEventListeners();var ht=new a(l,s),mt=new a(m,s),dt=new a(h,s);ht.enableValidation(),mt.enableValidation(),dt.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxHQUFXUCxVQUFVaEssRUFBS08sS0FBTVAsRUFBS1EsS0FDekMsSUFDQSxTQUFDc0ksR0FDRzBCLEdBQWdCUixZQUNoQlEsR0FBZ0JDLFdBQVUsV0FDdEJyQixHQUFJc0IsV0FBVzVCLEdBQVFULE1BQUssV0FDeEJpQyxFQUFRSyxhQUNSSCxHQUFnQnhFLFlBQ3BCLEdBQ0osR0FDSixJQUNBLFNBQUM4QyxFQUFROEIsR0FDREEsRUFDQXhCLEdBQUl5QixZQUFZL0IsR0FBUVQsTUFBSyxTQUFDeUMsR0FDMUJSLEVBQVE1SixNQUFRb0ssRUFBWXBLLE1BQzVCNEosRUFBUTVJLFdBQ1osSUFFQTBILEdBQUkyQixlQUFlakMsR0FBUVQsTUFBSyxTQUFDeUMsR0FDN0JSLEVBQVE1SixNQUFRb0ssRUFBWXBLLE1BQzVCNEosRUFBUTVJLFdBQ1osR0FFUixHQUNBNEgsR0FBWWxKLFFBRWhCZ0ssR0FBYVksUUFBUVYsRUFBUVcsV0FDN0JDLEdBQVVsRixZQUNkLEdBQ0osSUFFQWtGLEdBQVU5SCxvQkFDVnFDLEVBQWNwRCxpQkFBaUIsU0FBUyxXQUNwQzZJLEdBQVVsQixXQUNkLElBRUEsSUFBTU8sR0FBYSxJQUFJekQsRUFBZSxnQkFDdEN5RCxHQUFXbkgsb0JBSVgsSUFBTWdJLEdBQW9CLElBQUkvSCxFQUFjNkIsRUFBYTNCLEdBQ25EOEgsR0FBcUIsSUFBSWhJLEVBQWNrQyxFQUFhaEMsR0FDcEQrSCxHQUF1QixJQUFJakksRUFBY2lDLEVBQWdCL0IsR0FDL0Q2SCxHQUFrQkcsbUJBQ2xCRixHQUFtQkUsbUJBQ25CRCxHQUFxQkMsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0X2Fyb3VuZC8uL3NyYy9zY3JpcHRzL2FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF9hcm91bmQvLi9zcmMvc2NyaXB0cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfYXJvdW5kLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCBoYW5kbGVDbGlja0ltYWdlLCBoYW5kbGVDbGlja0RlbGV0ZSwgaGFuZGxlTGlrZVVwZGF0ZSwgdXNlcklkKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMubGluayA9IGRhdGEubGluaztcclxuICAgICAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgICAgIHRoaXMubGlrZXMgPSBBcnJheS5pc0FycmF5KGRhdGEubGlrZXMpID8gZGF0YS5saWtlcyA6IFtdO1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gdXNlcklkO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2xpY2tJbWFnZSA9IGhhbmRsZUNsaWNrSW1hZ2U7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVDbGlja0RlbGV0ZSA9IGhhbmRsZUNsaWNrRGVsZXRlO1xyXG4gICAgICAgIHRoaXMuaGFuZGxlTGlrZVVwZGF0ZSA9IGhhbmRsZUxpa2VVcGRhdGU7XHJcbiAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFByb3BlcnRpZXMoKSB7XHJcbiAgICAgICAgdGhpcy5odG1sQ2FyZCA9IHRoaXMuZ2V0VGVtcGxhdGUoKTtcclxuICAgICAgICB0aGlzLmNhcmRJbWFnZSA9IHRoaXMuaHRtbENhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19waG90b1wiKTtcclxuICAgICAgICB0aGlzLmNhcmRUaXRsZSA9IHRoaXMuaHRtbENhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19uYW1lLXBsYWNlXCIpO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uTGlrZUNhcmQgPSB0aGlzLmh0bWxDYXJkLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWxvdmVcIik7XHJcbiAgICAgICAgdGhpcy5idXR0b25EZWxldGVDYXJkID0gdGhpcy5odG1sQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvbi10cmFzaFwiKTtcclxuICAgICAgICB0aGlzLmNhcmRMaWtlcyA9IHRoaXMuaHRtbENhcmQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlXCIpXHJcbiAgICAgICAgdGhpcy5jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XHJcbiAgICAgICAgdGhpcy5jYXJkSW1hZ2Uuc3JjID0gdGhpcy5saW5rO1xyXG4gICAgICAgIHRoaXMuc2hvd0xpa2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd0xpa2VzKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZExpa2VzLnRleHRDb250ZW50ID0gdGhpcy5saWtlcy5sZW5ndGg7IFxyXG4gICAgICAgIHRoaXMuYnV0dG9uTGlrZUNhcmQuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2J1dHRvbi1sb3ZlX2FjdGl2ZVwiLCB0aGlzLmxpa2VzLmluY2x1ZGVzKHRoaXMudXNlcklkKSk7XHJcbiAgICB9XHJcblxyXG4gICAgaGFuZGxlTGlrZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaXNMaWtlZCA9IHRoaXMubGlrZXMuaW5jbHVkZXModGhpcy51c2VySWQpO1xyXG4gICAgICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlrZXMgPSB0aGlzLmxpa2VzLmZpbHRlcihpZCA9PiBpZCAhPT0gdGhpcy51c2VySWQpO1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUxpa2VVcGRhdGUodGhpcy5faWQsIGZhbHNlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxpa2VzLnB1c2godGhpcy51c2VySWQpO1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUxpa2VVcGRhdGUodGhpcy5faWQsIHRydWUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zaG93TGlrZXMoKTsgXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLmh0bWxDYXJkLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2xpY2tJbWFnZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uRGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmhhbmRsZUNsaWNrRGVsZXRlKHRoaXMuX2lkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmJ1dHRvbkxpa2VDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlTGlrZXMoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZU9uRXNjKGV2dCkge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VQb3BVcEltYWdlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlQ2xpY2tPdXRGb3JtKHBvcHVwLCBldnQpIHtcclxuICAgICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gcG9wdXApIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZVBvcFVwSW1hZ2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBvcGVuUG9wVXBJbWFnZSgpIHtcclxuICAgICAgICBjb25zdCBwb3BVcEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1pbWFnZVwiKTtcclxuICAgICAgICBjb25zdCBwb3BVcEltYWdlU3JjID0gcG9wVXBJbWFnZS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19waG90b1wiKTtcclxuICAgICAgICBjb25zdCBQb3BVcFRpdGxlSW1hZ2UgPSBwb3BVcEltYWdlLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3Bob3RvLXRpdGxlXCIpO1xyXG5cclxuICAgICAgICBwb3BVcEltYWdlLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgICAgIFBvcFVwVGl0bGVJbWFnZS50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcclxuICAgICAgICBwb3BVcEltYWdlU3JjLnNyYyA9IHRoaXMubGluaztcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5jbG9zZU9uRXNjLmJpbmQodGhpcykpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxyXG4gICAgICAgICAgICB0aGlzLmNsb3NlQ2xpY2tPdXRGb3JtKHBvcFVwSW1hZ2UsIGV2dClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgY2xvc2VQb3BVcEltYWdlKCkge1xyXG4gICAgICAgIGNvbnN0IHBvcFVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLWltYWdlXCIpO1xyXG4gICAgICAgIHBvcFVwSW1hZ2UuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuY2xvc2VPbkVzYy5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuc2V0UHJvcGVydGllcygpO1xyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5odG1sQ2FyZDtcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGZvcm1FbGVtZW50LCBzZXR0aW5ncykge1xyXG4gICAgICAgICh0aGlzLmZvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQpLCAodGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzKTtcclxuICAgICAgICB0aGlzLmlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgICAgdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuYnV0dG9uRWxlbWVudCA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBzaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcbiAgICBoaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIH1cclxuICAgIGNoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLnNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0XCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3N1Ym1pdF9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLXByb2ZpbGVcIik7XHJcbmV4cG9ydCBjb25zdCB0ZXh0VGl0bGVQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHRleHRTdWJ0aXRsZVByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXJcIik7XHJcbmV4cG9ydCBjb25zdCBmb3JtRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1hdmF0YXJcIilcclxuZXhwb3J0IGNvbnN0IGZvcm1BZGRDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLWNhcmRcIik7XHJcbmV4cG9ydCBjb25zdCBidXR0b25FZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYnV0dG9uQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYnV0dG9uLWFkZFwiKTtcclxuZXhwb3J0IGNvbnN0IGJ1dHRvbkVkaXRBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3Bob3RvX2VkaXRcIik7XHJcblxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMucG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmNsb3NlQnV0dG9uID0gdGhpcy5wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNDbG9zZSA9IHRoaXMuX2hhbmRsZUVzQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuUG9wdXAoKSB7XHJcbiAgICAgICAgdGhpcy5wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNDbG9zZSk7XHJcbiAgICB9XHJcbiAgICBjbG9zZVBvcHVwKCkge1xyXG4gICAgICAgIHRoaXMucG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzQ2xvc2UpO1xyXG4gICAgfVxyXG4gICAgX2hhbmRsZUVzQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaGFuZGxlQ2xpY2tPdXRzaWRlKGV2dCkge1xyXG4gICAgICAgIHJldHVybiBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX29wZW5cIik7XHJcbiAgICB9XHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLmNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMucG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmhhbmRsZUNsaWNrT3V0c2lkZShldnQpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cHtcclxuY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCl7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuZm9ybUVsZW1lbnQgPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLmlucHV0TGlzdCA9IHRoaXMuZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKTtcclxuICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7ICBcclxuICAgIHRoaXMuYnV0dG9uU3VibWl0ID0gdGhpcy5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3N1Ym1pdFwiKTtcclxufVxyXG5cclxuIGdldElucHV0VmFsdWVzKCl7XHJcbiB0aGlzLmZvcm1WYWx1ZXMgPSB7fTtcclxuIHRoaXMuaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KT0+e1xyXG4gICAgIHRoaXMuZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gfSk7XHJcbiByZXR1cm4gdGhpcy5mb3JtVmFsdWVzOyAgXHJcbiB9XHJcblxyXG5cclxuc2V0RXZlbnRMaXN0ZW5lcnMoKXtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpPT57XHJcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdGhpcy5oYW5kbGVGb3JtU3VibWl0KHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuYnV0dG9uU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xyXG4gICAgICAgIHRoaXMuYnV0dG9uU3VibWl0LnRleHRDb250ZW50ID0gXCJDYXJnYW5kby4uLlwiO1xyXG4gICAgfSk7XHJcbiB9XHJcblxyXG4gY2xvc2VQb3B1cCgpe1xyXG4gICAgIHN1cGVyLmNsb3NlUG9wdXAoKTtcclxuICAgICB0aGlzLmZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbn1cclxuXHJcbn1cclxuXHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKXtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMuaW1hZ2VFbGVtZW50ID0gdGhpcy5wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGhvdG9cIik7XHJcbiAgICAgICAgdGhpcy50aXRsZUVsZW1lbnQgPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19waG90by10aXRsZVwiKTtcclxuXHJcbiAgICB9XHJcbiAgICBvcGVuUG9wdXAodGl0bGUsIGxpbmspe1xyXG4gICAgICAgIHN1cGVyLm9wZW5Qb3B1cCgpO1xyXG4gICAgICAgIHRoaXMudGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgbmFtZSwgYWJvdXQsIGF2YXRhcn0pIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuYWJvdXQgPSBhYm91dDtcclxuICAgICAgICB0aGlzLmF2YXRhciA9IGF2YXRhcjtcclxuICAgIH1cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYWJvdXQ6IHRoaXMuYWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5hdmF0YXIuc3JjLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBzZXRVc2VySW5mbyhpbnB1dE5hbWUsIGlucHV0QWJvdXQpIHtcclxuICAgICAgICB0aGlzLm5hbWUudGV4dENvbnRlbnQgPSBpbnB1dE5hbWU7XHJcbiAgICAgICAgdGhpcy5hYm91dC50ZXh0Q29udGVudCA9IGlucHV0QWJvdXQ7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckF2YXRhcihpbnB1dEF2YXRhcil7XHJcbiAgICAgICAgdGhpcy5hdmF0YXIuc3JjID0gaW5wdXRBdmF0YXI7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbntcclxuICAgIGNvbnN0cnVjdG9yKHtpdGVtcywgcmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcil7XHJcbiAgICAgICAgdGhpcy5pdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbXMpID8gaXRlbXMgOiBbXTtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJdGVtcygpe1xyXG4gICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgIFxyXG5cclxuICAgIGFkZENhcmQoZWxlbWVudCl7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKGJhc2VVcmwsIGhlYWRlcnMpIHtcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlcigpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYGVycm9yIGVuIGxhIHBldGljacOzbmApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRVc2VyKG5hbWUsIGFib3V0KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQsXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciBlbiBsYSBwZXRpY2nDs25gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBlZGl0QXZhdGFyKGxpbmspIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYGVycm9yIGVuIGxhIHBldGljacOzbmApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgZXJyb3IgZW4gbGEgcGV0aWNpw7NuYCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlcy5vaykgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgZXJyb3IgZW4gbGEgcGV0aWNpw7NuYCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciBlbiBsYSBwZXRpY2nDs25gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRMaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciBlbiBsYSBwZXRpY2nDs25gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVMaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVzLm9rKSByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBlcnJvciBlbiBsYSBwZXRpY2nDs25gKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcil7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuYWN0aW9uID0gKCk9Pnt9O1xyXG59XHJcbnNldEFjdGlvbihhY3Rpb24pe1xyXG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XHJcbn1cclxuc2V0RXZlbnRMaXN0ZW5lcnMoKXtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICBjb25zdCBjb25maXJtQnV0dG9uID0gdGhpcy5wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNidXR0b25Db25maXJtYXRpb25cIik7XHJcbiAgICBpZiAoY29uZmlybUJ1dHRvbikge1xyXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hY3Rpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVsIGJvdMOzbiBkZSBjb25maXJtYWNpw7NuIG5vIHNlIGVuY29udHLDsyBlbiBlbCBwb3B1cC5cIik7XHJcbiAgICB9XHJcbn1cclxufSIsImltcG9ydCBcIi4vc3R5bGVzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi9zY3JpcHRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4vc2NyaXB0cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgICBzZXR0aW5ncyxcclxuICAgIGZvcm1Qcm9maWxlLFxyXG4gICAgdGV4dFRpdGxlUHJvZmlsZSxcclxuICAgIHRleHRTdWJ0aXRsZVByb2ZpbGUsXHJcbiAgICBhdmF0YXIsXHJcbiAgICBmb3JtRWRpdEF2YXRhcixcclxuICAgIGZvcm1BZGRDYXJkLFxyXG4gICAgYnV0dG9uRWRpdFByb2ZpbGUsXHJcbiAgICBidXR0b25BZGRDYXJkLFxyXG4gICAgYnV0dG9uRWRpdEF2YXRhcixcclxufSBmcm9tIFwiLi9zY3JpcHRzL3V0aWxzLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4vc2NyaXB0cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4vc2NyaXB0cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi9zY3JpcHRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi9zY3JpcHRzL2FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuL3NjcmlwdHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcblxyXG4vL2luc3RhbmNpYSBkZSBhcGkgcGFyYSBlbCBwcm95ZWN0b1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaShcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvd2ViLWVzLWNvaG9ydC0xNVwiLCB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjgwYjVlOTI1LTYwNWMtNDAwNi1iYTUwLWNjNDUyN2ZiMmU5NVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbn0pO1xyXG5cclxuLy9pbnN0YW5jaWEgcGFyYSBvYnRlbmVyIGxhIGluZm9ybWFjacOzbiBkZWwgdXN1YXJpb1xyXG5cclxuY29uc3QgbmV3VXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgbmFtZTogdGV4dFRpdGxlUHJvZmlsZSxcclxuICAgIGFib3V0OiB0ZXh0U3VidGl0bGVQcm9maWxlLFxyXG4gICAgYXZhdGFyOiBhdmF0YXIsXHJcbn0pO1xyXG5hcGkuZ2V0VXNlcigpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIG5ld1VzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS5hYm91dCwgZGF0YS5pZCk7XHJcbiAgICAgICAgbmV3VXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcblxyXG4vL2luc3RhbmNpYXMgeSBldmVudG9zIHBhcmEgZWRpdGFyIGVsIHBlcmZpbCAobm9tYnJlLCBwcm9mZXNpw7NuIHkgYXZhdGFyKVxyXG5cclxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcG9wdXAtcHJvZmlsZVwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcclxuICAgIGFwaS5lZGl0VXNlcihpbnB1dFZhbHVlcy5uYW1lLCBpbnB1dFZhbHVlcy5hYm91dClcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBuZXdVc2VySW5mby5zZXRVc2VySW5mbyhkYXRhLm5hbWUsIGRhdGEuYWJvdXQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICB9KTtcclxufSk7XHJcbnBvcHVwUHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5idXR0b25FZGl0UHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBQcm9maWxlLm9wZW5Qb3B1cCgpO1xyXG59KTtcclxuXHJcbmNvbnN0IHBvcHVwQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcG9wdXAtYXZhdGFyXCIsIChpbnB1dFZhbHVlcykgPT4ge1xyXG4gICAgYXBpLmVkaXRBdmF0YXIoaW5wdXRWYWx1ZXMuYXZhdGFyKVxyXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIG5ld1VzZXJJbmZvLnNldFVzZXJBdmF0YXIoZGF0YS5hdmF0YXIpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICB9KTtcclxufSk7XHJcblxyXG5wb3B1cEF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYnV0dG9uRWRpdEF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcG9wdXBBdmF0YXIub3BlblBvcHVwKCk7XHJcbn0pO1xyXG5cclxuLy9vYnRlbmVyIGNhcnRhcyBjb24gbGEgYXBpIHkgYWdyZWdhcmxhcyBlbiBsYSBpbnN0YW5jaWEgZGUgU2VjdGlvblxyXG5cclxuYXBpLmdldENhcmRzKClcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgc2VjdGlvbkNhcmRzLml0ZW1zID0gZGF0YTtcclxuICAgICAgICBzZWN0aW9uQ2FyZHMucmVuZGVySXRlbXMoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxuXHJcbmNvbnN0IHNlY3Rpb25DYXJkcyA9IG5ldyBTZWN0aW9uKFxyXG4gICAge1xyXG4gICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgICAgICAgICAgaXRlbSxcclxuICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBwb3B1cEltYWdlLm9wZW5Qb3B1cChpdGVtLm5hbWUsIGl0ZW0ubGluayk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcHVwRGVsZXRlQ2FyZC5vcGVuUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgICAgICBwb3B1cERlbGV0ZUNhcmQuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmRlbGV0ZUNhcmQoY2FyZElkKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBEZWxldGVDYXJkLmNsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgKGNhcmRJZCwgaXNMaWtlZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0xpa2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5hZGRMaWtlQ2FyZChjYXJkSWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXJkLmxpa2VzID0gdXBkYXRlZENhcmQubGlrZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXJkLnNob3dMaWtlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkucmVtb3ZlTGlrZUNhcmQoY2FyZElkKS50aGVuKCh1cGRhdGVkQ2FyZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FyZC5saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FyZC5zaG93TGlrZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIG5ld1VzZXJJbmZvLnVzZXJJZFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBzZWN0aW9uQ2FyZHMuYWRkQ2FyZChuZXdDYXJkLnNldENhcmQoKSk7XHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBcIi5jYXJkc1wiXHJcbik7XHJcblxyXG5jb25zdCBwb3B1cERlbGV0ZUNhcmQgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI3BvcHVwLWRlbGV0ZUNhcmRcIik7XHJcbnBvcHVwRGVsZXRlQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9pbnN0YW5jaWEgcGFyYSBhZ3JlZ2FyIG51ZXZhcyBjYXJ0YXNcclxuXHJcbmNvbnN0IHBvcHVwQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3BvcHVwLWNhcmRcIiwgKGlucHV0VmFsdWVzKSA9PiB7XHJcbiAgICBhcGkuY3JlYXRlQ2FyZChpbnB1dFZhbHVlcy50aXRsZSwgaW5wdXRWYWx1ZXMubGluaykudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgICAgICAgICAgZGF0YSxcclxuICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcG9wdXBJbWFnZS5vcGVuUG9wdXAoZGF0YS5uYW1lLCBkYXRhLmxpbmspO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAoY2FyZElkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBwb3B1cERlbGV0ZUNhcmQub3BlblBvcHVwKCk7XHJcbiAgICAgICAgICAgICAgICBwb3B1cERlbGV0ZUNhcmQuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBEZWxldGVDYXJkLmNsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAoY2FyZElkLCBpc0xpa2VkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5hZGRMaWtlQ2FyZChjYXJkSWQpLnRoZW4oKHVwZGF0ZWRDYXJkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NhcmQubGlrZXMgPSB1cGRhdGVkQ2FyZC5saWtlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FyZC5zaG93TGlrZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBpLnJlbW92ZUxpa2VDYXJkKGNhcmRJZCkudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2FyZC5saWtlcyA9IHVwZGF0ZWRDYXJkLmxpa2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDYXJkLnNob3dMaWtlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBuZXdVc2VySW5mby51c2VySWRcclxuICAgICAgICApO1xyXG4gICAgICAgIHNlY3Rpb25DYXJkcy5hZGRDYXJkKG5ld0NhcmQuc2V0Q2FyZCgpKTtcclxuICAgICAgICBwb3B1cENhcmQuY2xvc2VQb3B1cCgpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxucG9wdXBDYXJkLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmJ1dHRvbkFkZENhcmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHBvcHVwQ2FyZC5vcGVuUG9wdXAoKTtcclxufSk7XHJcblxyXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BvcHVwLWltYWdlXCIpO1xyXG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2luc3RhbmNpYXMgZGVsIHZhbGlkYWRvciBkZSBmb3JtdWxhcmlvc1xyXG5cclxuY29uc3QgdmFsaWRhdGlvbnByb2ZpbGUgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtUHJvZmlsZSwgc2V0dGluZ3MpO1xyXG5jb25zdCB2YWxpZGF0aW9uQWRkQ2FyZHMgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtQWRkQ2FyZCwgc2V0dGluZ3MpO1xyXG5jb25zdCB2YWxpZGF0aW9uRWRpdEF2YXRhciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1FZGl0QXZhdGFyLCBzZXR0aW5ncyk7XHJcbnZhbGlkYXRpb25wcm9maWxlLmVuYWJsZVZhbGlkYXRpb24oKTtcclxudmFsaWRhdGlvbkFkZENhcmRzLmVuYWJsZVZhbGlkYXRpb24oKTtcclxudmFsaWRhdGlvbkVkaXRBdmF0YXIuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4iXSwibmFtZXMiOlsiY2FyZFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsIkNhcmQiLCJkYXRhIiwiaGFuZGxlQ2xpY2tJbWFnZSIsImhhbmRsZUNsaWNrRGVsZXRlIiwiaGFuZGxlTGlrZVVwZGF0ZSIsInVzZXJJZCIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJuYW1lIiwibGluayIsIl9pZCIsImxpa2VzIiwiQXJyYXkiLCJpc0FycmF5Iiwic2V0UHJvcGVydGllcyIsImtleSIsInZhbHVlIiwiY2xvbmVOb2RlIiwiaHRtbENhcmQiLCJnZXRUZW1wbGF0ZSIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsImJ1dHRvbkxpa2VDYXJkIiwiYnV0dG9uRGVsZXRlQ2FyZCIsImNhcmRMaWtlcyIsInRleHRDb250ZW50Iiwic3JjIiwic2hvd0xpa2VzIiwibGVuZ3RoIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiaW5jbHVkZXMiLCJfdGhpcyIsImZpbHRlciIsImlkIiwicHVzaCIsInJlbW92ZSIsIl90aGlzMiIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVMaWtlcyIsImV2dCIsImNsb3NlUG9wVXBJbWFnZSIsInBvcHVwIiwidGFyZ2V0IiwiX3RoaXMzIiwicG9wVXBJbWFnZSIsInBvcFVwSW1hZ2VTcmMiLCJQb3BVcFRpdGxlSW1hZ2UiLCJhZGQiLCJjbG9zZU9uRXNjIiwiYmluZCIsImNsb3NlQ2xpY2tPdXRGb3JtIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50Iiwic2V0dGluZ3MiLCJpbnB1dExpc3QiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJidXR0b25FbGVtZW50Iiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJjb25jYXQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhpZGVJbnB1dEVycm9yIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNvbWUiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJjaGVja0lucHV0VmFsaWRpdHkiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm1TZWxlY3RvciIsImZvcm1Qcm9maWxlIiwidGV4dFRpdGxlUHJvZmlsZSIsInRleHRTdWJ0aXRsZVByb2ZpbGUiLCJhdmF0YXIiLCJmb3JtRWRpdEF2YXRhciIsImZvcm1BZGRDYXJkIiwiYnV0dG9uRWRpdFByb2ZpbGUiLCJidXR0b25BZGRDYXJkIiwiYnV0dG9uRWRpdEF2YXRhciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInBvcHVwRWxlbWVudCIsImNsb3NlQnV0dG9uIiwiX2hhbmRsZUVzQ2xvc2UiLCJjbG9zZVBvcHVwIiwiY29udGFpbnMiLCJoYW5kbGVDbGlja091dHNpZGUiLCJQb3B1cFdpdGhGb3JtIiwiX1BvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9jYWxsU3VwZXIiLCJidXR0b25TdWJtaXQiLCJfaW5oZXJpdHMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJfc3VwZXJQcm9wR2V0IiwiZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlBvcHVwV2l0aEltYWdlIiwiaW1hZ2VFbGVtZW50IiwidGl0bGVFbGVtZW50IiwidGl0bGUiLCJVc2VySW5mbyIsIl9yZWYiLCJhYm91dCIsImlucHV0TmFtZSIsImlucHV0QWJvdXQiLCJpbnB1dEF2YXRhciIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNhcmRJZCIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsImFjdGlvbiIsImNvbmZpcm1CdXR0b24iLCJjb25zb2xlIiwiZXJyb3IiLCJhcGkiLCJhdXRob3JpemF0aW9uIiwibmV3VXNlckluZm8iLCJnZXRVc2VyIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiY2F0Y2giLCJlcnIiLCJsb2ciLCJwb3B1cFByb2ZpbGUiLCJpbnB1dFZhbHVlcyIsImVkaXRVc2VyIiwib3BlblBvcHVwIiwicG9wdXBBdmF0YXIiLCJlZGl0QXZhdGFyIiwiZ2V0Q2FyZHMiLCJzZWN0aW9uQ2FyZHMiLCJyZW5kZXJJdGVtcyIsIm5ld0NhcmQiLCJwb3B1cEltYWdlIiwicG9wdXBEZWxldGVDYXJkIiwic2V0QWN0aW9uIiwiZGVsZXRlQ2FyZCIsInJlbW92ZUNhcmQiLCJpc0xpa2VkIiwiYWRkTGlrZUNhcmQiLCJ1cGRhdGVkQ2FyZCIsInJlbW92ZUxpa2VDYXJkIiwiYWRkQ2FyZCIsInNldENhcmQiLCJwb3B1cENhcmQiLCJjcmVhdGVDYXJkIiwidmFsaWRhdGlvbnByb2ZpbGUiLCJ2YWxpZGF0aW9uQWRkQ2FyZHMiLCJ2YWxpZGF0aW9uRWRpdEF2YXRhciIsImVuYWJsZVZhbGlkYXRpb24iXSwic291cmNlUm9vdCI6IiJ9